# ホロホロタロット メニュー作成ガイドライン

## 概要
このガイドは、ホロホロタロットの新しい占いメニューを作成する際の注意点と手順をまとめたものです。

---

## 📁 ファイル構造

### 主要ファイル
- **ホロホロタロット追加メニュー.xlsx** - メニューデータベース本体
  - メニューシート: 占いメニューの基本情報
  - 小項目シート: 各メニューの質問項目
  - 結果シート: タロット占い結果テキスト
- **card_name.csv** - タロットカードマスタデータ（44枚）

---

## 🎴 カード情報の確認（最重要）

### card_name.csvの構造
| カードID | 名称 | 読み | キーワード | 概要 | detail |
|---------|------|------|-----------|------|--------|
| 1 | I'O | イオ | ミステリー | 全ては必然で起こっている | （詳細説明） |
| 14 | ALOHA | アロハ | 愛 | 真の愛を学ぶ | （詳細説明） |
| ... | ... | ... | ... | ... | ... |

### ⚠️ 重要な注意点
1. **カード番号 = カードID**
   - 結果シートの「カード番号」列には、必ず`card_name.csv`の「カードID」を使用すること
   - 例: カード14は「ALOHA（アロハ）- 愛」

2. **鑑定文はカードの意味に沿って作成**
   - カードの「キーワード」と「概要」を必ず参照
   - カードの本質的な意味から外れないこと
   - 例: ALOHAカード（愛）を使う場合、エゴや依存のない真の愛について言及する

3. **カード選定のコツ**
   - メニューのテーマに合ったカードを選ぶ
   - 恋愛系: ALOHA(14), TAPA(3), POHAKU(36), HO'OPONOPONO(24), LAKA(23)など
   - 仕事系: MANO(9), LONO(8), KANE(40), PUA(34)など
   - 人生系: I'O(1), HUNA(7), PUEO(18), ANUENUE(42)など

---

## 📊 データベース構造

### 3層構造
```
メニュー (1)
  └── 小項目 (N)
        └── 結果 (N × カード枚数)
```

### 例: メニューID 301「あなたの結婚運鑑定」
- メニュー: 1件
- 小項目: 3件
  - 項目1: 運命の結婚相手の一目でわかる特徴は？
  - 項目2: その運命の人の内面はどんな感じ？
  - 項目3: 幸せな結婚をするためにあなたに必要なこと
- 結果: 12件 (3項目 × 4カード)

---

## 🆔 ID命名規則

### メニューID
- 連番で割り当て
- 現在の最大値を確認してから+1
- 例: 最大が1067なら、次は1068

### 項目ID（menu_id）
- フォーマット: `{メニューID}{項目番号:02d}`
- 例: メニュー1068の項目1 → 106801

### 結果ID（result_id）
- フォーマット: `{メニューID}{項目番号:02d}{結果番号:02d}`
- 例: メニュー1068、項目1、結果1 → 10680101

---

## 📝 メニュー作成手順

### STEP 1: 企画
1. メニューのジャンル選定（恋愛/仕事/金運/人生など）
2. メニュー名とキャプション決定
3. 小項目（質問）の数を決定（通常3〜5項目）
4. 各小項目の質問内容を決定

### STEP 2: カード選定
1. `card_name.csv`を開いて全カードを確認
2. メニューテーマに合ったカードを選定
3. 各小項目に4枚程度のカードを割り当て
   - 既存メニューのパターンを参考にする

```python
# カード確認用コード
import pandas as pd
card_df = pd.read_csv('card_name.csv', encoding='shift-jis')
print(card_df[['カードID', '名称', '読み', 'キーワード']])
```

### STEP 3: 鑑定文作成
1. 選定したカードごとに鑑定文を作成
2. **必須要素:**
   - カード名の明記: 「【カード名】のカードが出ました」
   - カードの概要引用: card_name.csvの「概要」列を参照
   - 具体的な鑑定内容
3. 文字数の目安: 200〜400文字程度

**鑑定文テンプレート:**
```
【{カード名}】のカードが出ました。{カードの概要}
{質問に対する具体的な鑑定内容}
{アドバイスや今後の展開}
```

### STEP 4: データ投入
1. メニューシートに1行追加
   - メニューID、メニュー名、キャプション、カテゴリー、公開日
2. 小項目シートに項目数分追加
   - メニューID、項目ID、項目名
3. 結果シートに結果を追加
   - メニューID、項目ID、結果ID、**カード番号（重要！）**、結果本文

---

## ✅ 作成後のチェックリスト

- [ ] カード番号がcard_name.csvのカードIDと一致している
- [ ] 各カードの意味（キーワード、概要）と鑑定文の内容が整合している
- [ ] 鑑定文にカード名が明記されている
- [ ] メニューID、項目ID、結果IDの命名規則が正しい
- [ ] 小項目の質問が明確で分かりやすい
- [ ] 各項目に適切な数のカードが割り当てられている（通常4枚程度）
- [ ] メニュー、小項目、結果の件数が整合している

---

## 🛠️ 便利なスクリプト

### 既存データのパターン確認
```python
# check_card_usage.py を実行
python check_card_usage.py
```

### カード情報の検索
```python
import pandas as pd
card_df = pd.read_csv('card_name.csv', encoding='shift-jis')

# キーワードで検索
keyword = '愛'
result = card_df[card_df['キーワード'].str.contains(keyword, na=False)]
print(result[['カードID', '名称', 'キーワード']])
```

---

## 📋 カテゴリー一覧

| カテゴリーID | カテゴリー名 |
|------------|------------|
| 1 | 恋愛・出会い |
| 3 | 結婚 |
| 7 | 人生・運勢 |
| 8 | 仕事・キャリア |
| 9 | 復縁 |

---

## 🎯 良い例・悪い例

### ❌ 悪い例
```
カード番号: 1
鑑定文: 「あの人はあなたに対してキラキラした瞳で見つめています...」
→ カード1（I'O - ミステリー）の意味と無関係な内容
```

### ✅ 良い例
```
カード番号: 14
鑑定文: 「【ALOHA】のカードが出ました。アロハという言葉は簡単に使われていますが、
実はとても深い意味を持つ言葉です。今、あの人はあなたに対して純粋な好意を抱いています。
それはエゴや依存のない、誠実な愛情です...」
→ カード14（ALOHA - 愛）の本質的な意味に沿った内容
```

---

## 📞 トラブルシューティング

### Q1: どのカードを選べばいいか分からない
**A:** 既存の似たジャンルのメニューを参考にする
```python
# 既存メニューのカード使用例を確認
python check_card_usage.py
```

### Q2: カード番号がおかしいと言われた
**A:** card_name.csvを開いて、カードIDを確認する（1〜44の範囲内）

### Q3: 鑑定文が書けない
**A:** card_name.csvの「detail」列を読んで、カードの深い意味を理解する

---

## 📚 参考資料

- `card_name.csv` - カードマスタデータ
- `check_card_usage.py` - カード使用パターン確認ツール
- `fix_menu_1068.py` - メニュー1068の修正例（参考コード）

---

**最終更新: 2025-11-10**
